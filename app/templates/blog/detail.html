{% extends "base.html" %}

{% block title %}{{ article.meta_title or article.title }}{% endblock %}
{% block meta_description %}{{ article.meta_description or article.excerpt or '' }}{% endblock %}
{% block canonical %}{{ site_url }}/{{ article.slug }}{% endblock %}
{% block og_type %}article{% endblock %}

{% block og_image %}
{% if article.og_image or article.featured_image %}
<meta property="og:image" content="{{ article.og_image or article.featured_image }}">
{% endif %}
{% endblock %}

{% block head %}
<style>
    .article-content h1 { font-size: 1.875rem; font-weight: 700; margin-top: 2rem; margin-bottom: 1rem; color: #1f2937; }
    .article-content h2 { font-size: 1.5rem; font-weight: 700; margin-top: 1.75rem; margin-bottom: 0.75rem; color: #1f2937; }
    .article-content h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; color: #1f2937; }
    .article-content p { margin-bottom: 1.25rem; line-height: 1.8; color: #374151; }
    .article-content ul, .article-content ol { margin-bottom: 1.25rem; padding-left: 1.5rem; }
    .article-content li { margin-bottom: 0.5rem; line-height: 1.7; color: #374151; }
    .article-content ul li { list-style-type: disc; }
    .article-content ol li { list-style-type: decimal; }
    .article-content a { color: #16a34a; text-decoration: underline; }
    .article-content a:hover { color: #15803d; }
    .article-content blockquote { border-left: 4px solid #22c55e; padding-left: 1rem; margin: 1.5rem 0; color: #6b7280; font-style: italic; }
    .article-content code { background: #f3f4f6; padding: 0.125rem 0.375rem; border-radius: 0.25rem; font-size: 0.875rem; }
    .article-content pre { background: #1f2937; color: #f9fafb; padding: 1rem; border-radius: 0.5rem; overflow-x: auto; margin-bottom: 1.25rem; }
    .article-content pre code { background: none; padding: 0; }
    .article-content img { max-width: 100%; height: auto; border-radius: 0.5rem; margin: 1.5rem 0; }
    .article-content table { width: 100%; border-collapse: collapse; margin-bottom: 1.25rem; }
    .article-content th, .article-content td { border: 1px solid #e5e7eb; padding: 0.5rem 0.75rem; text-align: left; }
    .article-content th { background: #f9fafb; font-weight: 600; }
</style>
{% endblock %}

{% block breadcrumbs %}
<nav aria-label="Breadcrumb" class="mb-6">
    <ol class="flex items-center gap-2 text-sm text-gray-500">
        <li><a href="/blog" class="hover:text-fire-700">Blog</a></li>
        {% if article.category %}
        <li><span class="mx-1">/</span></li>
        <li><a href="/kategoria/{{ article.category.slug }}" class="hover:text-fire-700">{{ article.category.name }}</a></li>
        {% endif %}
        <li><span class="mx-1">/</span></li>
        <li class="text-gray-800 font-medium truncate max-w-xs">{{ article.title }}</li>
    </ol>
</nav>
{% endblock %}

{% block content %}
<article class="max-w-3xl">
    <!-- Header -->
    <header class="mb-8">
        <h1 class="text-3xl sm:text-4xl font-bold text-gray-900 leading-tight mb-4">
            {{ article.title }}
        </h1>
        <div class="flex items-center gap-4 text-sm text-gray-500">
            <time datetime="{{ (article.published_at or article.created_at).isoformat() }}">
                {{ (article.published_at or article.created_at).strftime('%d %B %Y') }}
            </time>
            {% if article.category %}
            <a href="/kategoria/{{ article.category.slug }}" class="text-fire-700 hover:text-fire-800">
                {{ article.category.name }}
            </a>
            {% endif %}
        </div>
    </header>

    {% if article.featured_image %}
    <img src="{{ article.featured_image }}" alt="{{ article.title }}"
         class="w-full rounded-lg mb-8 shadow-sm">
    {% endif %}

    <!-- Content -->
    <div class="article-content text-lg">
        {{ article.content_html | safe }}
    </div>

    <!-- Tags -->
    {% if article.tags %}
    <div class="mt-8 pt-6 border-t border-gray-200">
        <div class="flex flex-wrap gap-2">
            {% for tag in article.tags %}
            <a href="/tag/{{ tag.slug }}"
               class="text-sm bg-gray-100 text-gray-600 px-3 py-1 rounded-full hover:bg-fire-50 hover:text-fire-700 transition-colors">
                #{{ tag.name }}
            </a>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <!-- Comments (HTMX lazy load) -->
    <section class="mt-12 pt-8 border-t border-gray-200">
        <h2 class="text-xl font-bold text-gray-800 mb-6">Komentarze</h2>
        <div hx-get="/htmx/comments/{{ article.id }}" hx-trigger="load" hx-swap="innerHTML">
            <p class="text-sm text-gray-400">≈Åadowanie komentarzy...</p>
        </div>
    </section>
</article>
{% endblock %}
