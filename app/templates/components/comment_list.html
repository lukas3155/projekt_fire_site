<!-- Comment form -->
<form hx-post="/htmx/comments"
      hx-target="#comments-list"
      hx-swap="afterbegin"
      hx-on::after-request="if(event.detail.successful) this.reset()"
      class="bg-white rounded-lg shadow-sm p-6 mb-6">

    <!-- Honeypot -->
    <div style="position: absolute; left: -9999px;">
        <input type="text" name="website" tabindex="-1" autocomplete="off">
    </div>

    <input type="hidden" name="article_id" value="{{ article_id }}">

    <div class="mb-4">
        <label for="nickname" class="block text-sm font-medium text-gray-700 mb-1">Nick</label>
        <input type="text" id="nickname" name="nickname" required maxlength="100"
               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-fire-500 focus:border-transparent text-sm">
    </div>
    <div class="mb-4">
        <label for="comment_content" class="block text-sm font-medium text-gray-700 mb-1">Komentarz</label>
        <textarea id="comment_content" name="content" required rows="4" maxlength="2000"
                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-fire-500 focus:border-transparent text-sm"></textarea>
    </div>
    <button type="submit"
            class="bg-fire-600 text-white px-4 py-2 rounded-md hover:bg-fire-700 transition-colors text-sm font-medium">
        Dodaj komentarz
    </button>
</form>

<div id="comment-errors"></div>

<!-- Comments -->
<div id="comments-list">
    {% for comment in comments %}
    <div class="bg-white rounded-lg shadow-sm p-5 mb-3">
        <div class="flex items-center gap-3 mb-2">
            <span class="font-medium text-gray-800 text-sm">{{ comment.nickname }}</span>
            <time datetime="{{ comment.created_at.isoformat() }}" class="text-xs text-gray-400">
                {{ comment.created_at.strftime('%d.%m.%Y %H:%M') }}
            </time>
        </div>
        <p class="text-gray-700 text-sm leading-relaxed">{{ comment.content }}</p>
    </div>
    {% endfor %}

    {% if not comments %}
    <p class="text-sm text-gray-400">Brak komentarzy. Bądź pierwszy!</p>
    {% endif %}
</div>
